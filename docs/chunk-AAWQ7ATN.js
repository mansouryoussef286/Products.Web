import{b as c,d as p,e as b}from"./chunk-DJ7TFCX2.js";import{c as d,d as g,g as P,i as m,j as f,k as C,m as u,o as a}from"./chunk-77BZXM6W.js";var l=function(r){return r.Asc="asc",r.Desc="desc",r}(l||{}),h=class{constructor(i,S){this.PageIndex=0,this.PageSize=25,this.PageSizeOptions=[25,50,100,200],this.SortField=i,this.SortOrder=S}};var q=(()=>{let i=class i{set ProductsResponse(t){this.productsResponse=t,this.GridOptions.Count=t.total,this.ProductsResponse$.next(this.productsResponse)}set Categories(t){this.categories=t,this.Categories$.next(this.categories)}set SearchInput(t){this.searchInput=t,this.searchSubject$.next(this.searchInput)}get SearchInput(){return this.searchInput}set SelectedCategory(t){this.selectedCategory=t=="All"?"":t,this.GetProducts(),this.searchInput=""}get SelectedCategory(){return this.selectedCategory}set GridOptions(t){this.searchInput="",this.gridOptions=t,this.GetProducts()}get GridOptions(){return this.gridOptions}constructor(t){this.HttpService=t,this.ProductsResponse$=new d,this.Categories$=new d,this.searchSubject$=new d,this.searchInput="",this.gridOptions=new h("",l.Asc)}InitSearchSub(){this.searchSubject$.pipe(m(300),f(),P(t=>t.length>2||t==""),C(t=>this.search(t))).subscribe(t=>{this.ProductsResponse=t})}search(t){this.selectedCategory="",this.gridOptions=new h("",l.Asc);let e=c.Products.Search;return e=e.replace("{query}",t),this.HttpService.Get(e)}GetProducts(){let t="";this.SelectedCategory&&(t=`/category/${this.SelectedCategory}`);let e=this.GetProductsQueryParam(),s=c.Products.GetAll+t+e;this.HttpService.Get(s).subscribe(o=>{this.ProductsResponse=o})}GetCategories(){let t=c.Products.Categories;this.HttpService.Get(t).subscribe(e=>{this.Categories=e})}GetProductsQueryParam(){let t="?";return this.GridOptions.PageSize&&(t+=`limit=${this.GridOptions.PageSize}&`),this.GridOptions.PageIndex&&(t+=`skip=${this.GridOptions.PageSize*this.GridOptions.PageIndex}&`),this.GridOptions.SortField&&(t+=`sortBy=${this.GridOptions.SortField}&order=${this.GridOptions.SortOrder}`),t}};i.\u0275fac=function(e){return new(e||i)(a(p))},i.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();var n;(function(r){class i{}r.ApiResponse=i;class S{}r.Cart=S;class t{}r.Product=t;class e{}r.ReqModel=e;class s{constructor(G,I){this.id=G,this.quantity=I}}r.ProductReqModel=s})(n||(n={}));var F=(()=>{let i=class i{get Cart(){return this.Cart$.getValue()}constructor(t,e){this.HttpService=t,this.AuthService=e,this.Cart$=new g(new n.Cart),this.InitUserSub()}InitUserSub(){this.AuthService.CurrentUserSub.subscribe(t=>{t&&this.GetCart()}),this.AuthService.IsAuthenticated&&setTimeout(()=>{this.GetCart()},200)}GetCart(){let t=c.Cart.Get;t=t.replace("{id}",this.AuthService.CurrentUser.id.toString()),this.HttpService.Get(t).subscribe(e=>{this.Cart$.next(e.carts[0])})}AddToCart(t){let e=c.Cart.Update;e=e.replace("{id}",this.Cart.id.toString());let s=new n.ReqModel;s.merge=!0,s.products=[new n.ProductReqModel(t.id,1)],this.HttpService.Put2(e,s).subscribe(o=>{this.Cart$.next(o),alert(`Added one "${t.title}" to your cart!`)})}AddToCartOnServer(t){let e=c.Cart.Update;e=e.replace("{id}",this.Cart.id.toString());let s=new n.ReqModel;return s.merge=!0,s.products=[new n.ProductReqModel(t.id,1)],console.log(s),this.HttpService.Put2(e,s)}};i.\u0275fac=function(e){return new(e||i)(a(p),a(b))},i.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();export{l as a,h as b,q as c,F as d};
