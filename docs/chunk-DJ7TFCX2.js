import{a as m,aa as u,b as U,c as l,d as v,f as c,h as a,l as A,m as h,o as p}from"./chunk-77BZXM6W.js";var n=function(o){return o.AccessToken="AccessToken",o.RefreshToken="RefreshToken",o.CurrentUser="CurrentUser",o}(n||{}),S=(()=>{let r=class r{SetSessionStorage(t,e){let i=JSON.stringify(e);sessionStorage.setItem(t,i)}GetSessionStorage(t){let e=sessionStorage.getItem(t);return e?JSON.parse(e):null}RemoveSessionStorage(t){sessionStorage.removeItem(t)}SetLocalStorage(t,e){let i=JSON.stringify(e);localStorage.setItem(t,i)}GetLocalStorage(t){let e=localStorage.getItem(t);return JSON.parse(e||"{}")}RemoveLocalStorage(t){localStorage.removeItem(t)}};r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=h({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();var k=(()=>{let r=class r{};r.Account={Login:"auth/login",Refresh:"auth/refresh"},r.Products={GetOne:"products/{id}",GetAll:"products",Categories:"products/categories",Search:"products/search?q={query}"},r.Cart={Get:"carts/user/{id}",Update:"carts/{id}"};let o=r;return o})();var C=(()=>{let r=class r{constructor(t){this.HttpClient=t,this.hostname=window.location.hostname,this.ApiUrl=new l}LoadAppConfig(){return U(this,null,function*(){console.log("Client: "+this.hostname),this.HttpClient.get("assets/Config/Env.json").subscribe(t=>{this.env=t.find(e=>e.Web==this.hostname),console.log("env: ",m({},this.env)),this.ApiUrl.next(this.env.ApiUrl)})})}};r.\u0275fac=function(e){return new(e||r)(p(u))},r.\u0275prov=h({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();var b=(()=>{let r=class r{constructor(t,e,i){this.HttpClient=t,this.StorageService=e,this.AppConfig=i,this.ApiUrl="",this.SetApiUrl()}SetApiUrl(){this.AppConfig.ApiUrl.subscribe(t=>{this.ApiUrl=t,console.log(`api url: 
`,this.ApiUrl)})}Get(t){let e=this.ApiUrl+t;return this.HttpClient.get(e).pipe(a(i=>c(()=>i)))}Post(t,e){let i=this.ApiUrl+t;return this.HttpClient.post(i,e).pipe(a(s=>c(()=>s)))}Put(t,e){let i=this.ApiUrl+t;return this.HttpClient.put(i,e).pipe(a(s=>c(()=>s)))}Put2(t,e){let i=this.ApiUrl+t;return this.HttpClient.put(i,e).pipe(a(s=>c(()=>s)))}Delete(t){let e=this.ApiUrl+t;return this.HttpClient.delete(e).pipe(a(i=>c(()=>i)))}GetWithOptions(t,e){let i=this.ApiUrl+t;return this.HttpClient.get(i,e).pipe(a(s=>c(()=>s)))}GetWithParams(t,e){let i=this.ApiUrl+t,s={params:e};return this.HttpClient.get(i,s).pipe(a(f=>c(()=>f)))}PostWithOptions(t,e,i){let s=this.ApiUrl+t;return this.HttpClient.post(s,e,i).pipe(a(f=>c(()=>f)))}PutWithRes(t,e){let i=this.ApiUrl+t;return this.HttpClient.put(i,e).pipe(a(s=>c(()=>s)))}Patch(t,e){let i=this.ApiUrl+t;return this.HttpClient.patch(i,e).pipe(a(s=>c(()=>s)))}PatchWithRes(t,e){let i=this.ApiUrl+t;return this.HttpClient.patch(i,e).pipe(a(s=>c(()=>s)))}};r.\u0275fac=function(e){return new(e||r)(p(u),p(S),p(C))},r.\u0275prov=h({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();var w=(()=>{let r=class r{constructor(t,e){this.StorageService=t,this.HttpService=e,this.CurrentUserSub=new v(!1),this.ProfilePicUpdate=new l}SignIn(t){this.StorageService.SetLocalStorage(n.AccessToken,t.token),this.StorageService.SetLocalStorage(n.RefreshToken,t.refreshToken),this.StorageService.SetLocalStorage(n.CurrentUser,t),this.CurrentUserSub.next(!0)}SignOut(){this.StorageService.RemoveLocalStorage(n.AccessToken),this.StorageService.RemoveLocalStorage(n.RefreshToken),this.StorageService.RemoveLocalStorage(n.CurrentUser)}get AccessToken(){let t=this.StorageService.GetLocalStorage(n.AccessToken);return Object.keys(t).length==0?"":t}set AccessToken(t){this.StorageService.SetLocalStorage(n.AccessToken,t)}get RefreshToken(){let t=this.StorageService.GetLocalStorage(n.RefreshToken);return Object.keys(t).length==0?"":t}set RefreshToken(t){this.StorageService.SetLocalStorage(n.RefreshToken,t)}get CurrentUser(){return this.StorageService.GetLocalStorage(n.CurrentUser)}get IsAuthenticated(){return Object.keys(this.CurrentUser).length!=0}RefreshAccessToken(){let t={refreshToken:this.RefreshToken,expiresInMins:60};if(!t.refreshToken)return;let e=k.Account.Refresh;return this.HttpService.Post(e,t).pipe(A(i=>{this.AccessToken=i.token,this.RefreshToken=i.refreshToken}))}};r.\u0275fac=function(e){return new(e||r)(p(S),p(b))},r.\u0275prov=h({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();export{S as a,k as b,C as c,b as d,w as e};
